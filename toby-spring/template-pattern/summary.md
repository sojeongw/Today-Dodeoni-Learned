# 정리

3장에서는 리소르를 안전하게 반환하고 예외처리를 보장해주는 DAO 코드를 만들었다. 

객체 지향 설계 원리와 디자인 패턴, DI 등을 적용해 깔끔하고 유연하며 단순한 코드로 리팩토링을 진행했다.

- JDBC처럼 공유 리소스를 꼭 반환해야 하고 예외가 발생할 가능성이 있는 코드는 꼭 `try/catch/finally`로 관리해야 한다.

- 일정한 작업 흐름 중에 일부만 바뀌는 코드가 존재한다면 전략 패턴을 이용한다.

- 전략 패턴 사용 시 바뀌지 않는 부분은 컨텍스트, 바뀌는 부분은 전략으로 만든다.
 
- 전략은 인터페이스로 구현해 유연하게 바뀔 수 있도록 한다.

- 한 애플리케이션 안에서 여러 전략을 다이내믹하게 구성해야 한다면 컨텍스트를 사용하는 클라이언트 메소드에서 직접 전량을 정의하고 제공하게 한다.

- 컨텍스트가 여러 클라이언트 오브젝트에서 사용된다면 클래스를 분리해서 공유한다.

- 컨텍스트는 별도의 빈으로 등록해서 DI 받거나 클라이언트에서 직접 생성해 사용한다.

- 클래스 내부에서 컨텍스트를 사용할 때 컨텍스트가 의존하는 외부 오브젝트가 있다면 직접 DI할 수 있다.

- 전략 패턴이면서 익명 내부 클래스로 매번 새 전략을 만들어 사용하고, 컨텍스트를 호출하면서 DI를 수행하면 방식을 템플릿/콜백이라고 한다.

- 콜백에도 일정한 패턴이 반복된다면 콜백을 템플릿에 넣어 재활용한다.

- 제네릭스를 이용해 템플릿과 콜백의 타입을 다양하게 사용할 수 있다.

- 스프링은 JDBC 사용을 위해 JdbcTemplate을 기반으로 다양한 템플릿과 콜백을 제공한다.

- 템플릿은 한 번에 여러 콜백을 사용할 수도, 하나의 콜백을 여러 번 호출할 수도 있다.

- 템플릿/콜백을 설계할 때는 템플릿과 콜백이 서로 주고받는 정보에 관심을 둬야 한다.

템플릿/콜백은 스프링의 객체지향 설계를 잘 보여주는 예다. 스프링이 제공하는 템플릿/콜백을 잘 사용하는 것은 물론이고 직접 만들어 활용할 수도 있어야 한다.