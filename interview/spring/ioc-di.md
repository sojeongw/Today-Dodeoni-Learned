# 제어의 역전과 의존성 주입
## 제어의 역전

- 내가 사용할 의존성을 외부 즉, 프레임워크게 맡기는 것
- 스프링에서 IoC를 담당하는 컨테이너가 `빈 팩토리` 또는 `애플리케이션 컨텍스트`라고 불린다.

### BeanFactory

- 빈 인스턴스를 제공하고 관리하는 컨테이너의 인터페이스
- 스프링 IoC 컨테이너 최상위에 있음
- 빈 생성과 라이프사이클을 관리

### ApplicationContext

- 메타데이터, 빈 등 애플리케이션의 모든 정보를 가진 컨테이너
- BeanFactory 상속
- 애플리케이션이 시작할 때 빈을 초기화 함
- 리소스 로딩, 이벤트 발생, 다국어 등의 기능 추가

## 의존성 주입

- 사용할 객체를 직접 생성하지 않고 밖에서 주입 받는 것
- 의존하는 객체를 직접 생성하고 검색할 필요가 없어 코드 관리가 쉬워진다.
- IoC 컨테이너가 필요한 클래스를 초기화한다.

## 빈

- IoC 컨테이너가 관리하는 객체

## 빈 스코프

- 싱글톤이 기본값
- 애플리케이션 전반에 걸쳐 빈 인스턴스가 하나만 존재한다.
- 객체는 생성할 때마다 메모리를 할당받아야 하므로 이러한 메모리 낭비를 방지한다.
- 

## 빈 주입
### Constructor

- 가장 권장하는 방법
- 필수로 사용할 레퍼런스가 없으면 인스턴스를 만들지 못하기 때문
- 불변, 필수적인 의존 관계에 사용한다.
- 호출 시점에 딱 한번만 생성되는걸 보장한다.
- 순환 참조가 발생할 수 있다.
    - 서로가 생성자 주입을 하고 있다면 인스턴스를 생성할 수 없다.
    - 필드 주입이나 setter 주입으로 대체 가능하다.
    - 되도록 순환 참조가 발생하지 않도록 설계하는 게 제일 좋다.
- 스프링 4.3부터 생성자가 하나이며 주입받는 레퍼런스 변수가 빈으로 등록되어 있다면 `@Autowired` 생략 가능하다.

### Setter

- 해당 클래스의 인스턴스를 만든 후 IoC 컨테이너에 있는 빈 중에 주입할 타입을 찾아 setter로 넣어준다.
- 선택, 변경 가능성이 있는 의존 관계에 사용한다.
- 스프링 빈을 선택적으로 등록할 수 있다.

### Field

- `@Autowired`를 이용해 주입한다.
- 외부에서 변경이 불가능해 테스트가 힘들다.
- DI 프레임워크가 없으면 동작하기 어렵다.
- 애플리케이션 코드와 관계 없는 테스트 코드나 스프링 설정 목적으로 사용한다.
- final을 붙일 수 없다.
    - final은 생성자 주입으로만 초기화 할 수 있다.
    - final을 생성자 주입에 반드시 써야하는 건 아니지만 레퍼런스가 바뀌지 않는 걸 보장하기 위해서다.
    
